<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="gen_3480">
    <select id="dorm_rqst_list" resultType="GenDormRqst">
        SELECT
           A.RQST_NO,
           A.RQST_DT,
           B.EMP_NM,
           C.DEPT_NM,
           D.COMM_NM AS GRD_NM,
           A.HOPE_DT ,
           A.ACT_DT,
           A.HOUSE_NO,
           A.ROOM_NO,
           A.ROOM_NO_SEQ,
           FN_GET_COMM_NM(E.APV_STAT_CD) AS APV_STAT_NM,
           FN_GET_COMM_NM(A.EMP_CLS) AS EMP_CLS_NM,
           F.COMM_NM AS CLS_NM,
           G.COMM_NM AS ROOM_CLS_NM
        FROM GEN_DORM_RQST A
        LEFT OUTER JOIN HRM_BAS_MGT B
        ON A.EMP_NO=B.EMP_NO
        LEFT OUTER JOIN HRM_DEPT C
        ON A.DEPT_CD=C.DEPT_CD
        LEFT OUTER JOIN HRM_BAS_DTL DTL
        ON A.EMP_NO=DTL.EMP_NO
        LEFT OUTER JOIN COM_STD_MGT D
        ON DTL.GRD_CD=D.COMM_CD
        LEFT OUTER JOIN COM_RQST_NO E
        ON A.RQST_NO=E.RQST_NO
        LEFT OUTER JOIN COM_STD_MGT F
        ON A.CLS=F.COMM_CD
        LEFT OUTER JOIN GEN_DORM DORM
        ON A.ROOM_NO=DORM.ROOM_NO
        LEFT OUTER JOIN COM_STD_MGT G
        ON DORM.ROOM_CLS=G.COMM_CD
        WHERE  A.RQST_CLS = '493-040'
        AND A.RQST_DT BETWEEN #{frDt} and #{toDt}
        AND (A.EMP_NM LIKE #{empNm}||'%' AND A.EMP_NO LIKE #{empNo}||'%')
        AND c.DEPT_NM LIKE #{deptNm} ||'%'
        AND E.APV_STAT_CD LIKE #{apvStatCd}||'%'
        AND DTL.GRD_CD LIKE #{grdCd}||'%'
        AND HOPE_DT LIKE TO_CHAR(TO_DATE(#{hopeDt},'YYYY-MM-DD'),'YYYYMMDD')||'%'
    </select>
</mapper>